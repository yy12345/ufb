<div class="body">
	<!--开始 body内容替换区域-->
	<section class="loadbody">
		<div class="container">
			<div class="boxC">
				<div class="itemD">
                	<div class="a1">学生档案管理</div>
                </div>
			</div>
			<div class="boxB">
				<div class="itemH">
                	<div class="a1 cl">
                    	<div class="b1">班级选择</div>
                        <div class="b2">
                        	<div class='c1 #if("${typeid}" == "0")active#end'><a typeid="0" href="${ufbDomain}/school/student_manager.htm">全部</a></div>
                            #foreach($ct in $allTypes)
                            <div class='c1 #if("${typeid}" == "${ct.id}")active#end'>
                            	<a typeid="${ct.id}" href="${ufbDomain}/school/student_manager.htm?typeid=${ct.id}">${ct.name}</a>
                            </div>
                            #end
                        </div>
                        <div class="b3"><a href="${ufbDomain}/school/class_setting.htm">年级/班级设置</a></div>
                    </div>
					<div class="a3">
						<div class="b1 cl">
							<a href="javascript:;" class="c3">+新档案</a>
							<a href="javascript:;" class="c1 active">批量导入</a>
							<a href="javascript:;" class="c1">调班</a>
						</div>
						<div class="b2">
							<div class="c1 tabCon active">
                            	<div class="d1">下载：<a id="downTemplate" href="javascript:void(0);">档案模版</a></div>
                                <div class="d2">
                                	<form id="uploadForm" enctype="multipart/form-data">
                                        <span>仅支持学费通模板文件导入</span>
                                        <label class="inputFile">
	                                        <input id="uploadFile" name="file" type="file">
	                                        <b>选择文件（Excel）</b>
                                        </label>
                                        <input id="uploadBtn" type="button" value="确定">
                                    </form>
                                </div>
							</div>
						</div>
					</div>
					<div class="listStu">
						#foreach($c in $clazzList)
						<div class="a4">
			            	<div class="b1 cl">
			                	<div class="c1">
				                	<label class="checkbox"><input type="checkbox">${c.name}</label>
				                	<span class="d1">${c.size}</span><span>人</span>
			                	</div>
			                    <div class="c2" data-href="${ufbDomain}/school/student_list.htm?cid=${c.cid}"></div>
			                </div>
			                <div class="b2"></div>
						</div>
						#end
					</div>
					<!-- listStu end  -->
                </div>
			</div>
		</div>
		
		<!--开始 本页面JS-->
		<script type="text/javascript">
			$('nav a:eq(1)').addClass('active');
		
			// 下载档案模板
			$('#downTemplate').on('click', function(){
				var typeid = $('.itemH .a1 .b2 .c1').filter('.active').find('a').attr('typeid');
				var type_name = $('.itemH .a1 .b2 .c1').filter('.active').find('a').html();
				$.confirm({
					title:'您将下载【'+type_name+'】类型的班级模板',
					complete:function(){
						var url = '${ufbDomain}/school/student_downTemplate.htm?typeid='+typeid;
						window.open(url, '_blank', '');
					}
				});
			});
			
			// 上传档案模板
			$('#uploadBtn').on('click',function(){
				var filename = $('#uploadFile').val();
				if(filename == ''){
					$.alert({title:'请选择要上传的文件！'});
					return false;
				}else{
					$.alert({title:'正在导入，请稍等...'});
				}
				$('#uploadForm').ajaxSubmit({
					url:'${ufbDomain}/school/student_upload.ajax',
					type:'POST',
					resetForm:true,
					clearForm:true,
					success: function(data){
						var json = $.parseJSON(data);
						if(json.errCode=='0000'){
							$.alert({title:'导入成功！',time:2});
							location.href = '${ufbDomain}/school/student_manager.htm?typeid='+json.typeid;
							return;
						}else{
							$.alert({title:json.errMsg,time:5});
						}
					},
					error: function(XMLHttpRequest, textStatus, errorThrown) {
						$.alert({title:'系统出现异常！'});
					}
				});
			})
			
			// 展开、隐藏班级详细
			$('.itemH').on('click','.a4 .b1 .c2',function(){
				if($(this).hasClass('active')){
					$(this).removeClass('active');
					$(this).closest('.b1').next().hide();
				}else{
					$(this).addClass('active');
					$(this).closest('.b1').next().show();
					if($(this).closest('.b1').next().children().length==0){
						JH.load.add($(this).attr('data-href'),$(this).closest('.b1').next());
					}
				}
			});
		</script>
		<!--结束 本页面JS-->
	</section>
	<!--结束 body内容替换区域-->
</div>